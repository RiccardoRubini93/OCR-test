{"ast":null,"code":"import React,{useState}from'react';import{apiUrl}from'./api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const accentGradient='linear-gradient(90deg, #a259ff 0%, #4f8cff 100%)';const accentText={background:accentGradient,WebkitBackgroundClip:'text',WebkitTextFillColor:'transparent',fontWeight:700};function SimilaritySearch(_ref){let{projectId}=_ref;const[query,setQuery]=useState('');const[results,setResults]=useState([]);const[loading,setLoading]=useState(false);const[error,setError]=useState('');const handleSearch=async e=>{e.preventDefault();setLoading(true);setError('');setResults([]);try{const res=await fetch(apiUrl('/texts/similarity'),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({query,project_id:projectId?Number(projectId):undefined})});const data=await res.json();setResults(data);}catch(err){setError('Failed to fetch similarity results');}setLoading(false);};return/*#__PURE__*/_jsxs(\"div\",{className:\"main-responsive-box\",style:{width:'100%',maxWidth:1100,margin:'0 auto',padding:'0 5vw'},children:[/*#__PURE__*/_jsx(\"h2\",{style:{fontSize:38,marginBottom:32,...accentText},children:\"Similarity Search (Embeddings)\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSearch,className:\"row g-2 align-items-center mb-4\",style:{marginBottom:32},children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-12 col-md-9 mb-2 mb-md-0\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:query,onChange:e=>setQuery(e.target.value),placeholder:\"Enter a query to find similar texts...\",className:\"form-control bg-dark text-white\",style:{padding:16,borderRadius:12,border:'2px solid #4f8cff',fontSize:18,fontWeight:500}})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-12 col-md-3 d-grid\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",style:{borderRadius:12,padding:'14px 36px',fontWeight:700,fontSize:18},children:\"Search\"})})]}),loading&&/*#__PURE__*/_jsx(\"div\",{style:{color:'#bfc9d9'},children:\"Loading...\"}),error&&/*#__PURE__*/_jsx(\"div\",{style:{color:'#e63946'},children:error}),!loading&&!error&&results.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"d-flex flex-column gap-4\",children:results.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"mx-auto w-100\",style:{background:'#191919',borderRadius:20,boxShadow:'0 2px 12px rgba(162,89,255,0.08)',padding:32,color:'#fff',fontSize:18,fontWeight:500,maxWidth:900,border:'1.5px solid #232323'},children:[item.filename&&/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:10,color:'#bfc9d9',fontSize:16},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:700,color:'#fff'},children:\"File:\"}),\" \",item.filename]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:10,color:'#bfc9d9',fontSize:16},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:700,color:'#fff'},children:\"Saved:\"}),\" \",new Date(item.created_at).toLocaleString(),\" | \",/*#__PURE__*/_jsx(\"span\",{style:{color:'#a259ff',fontWeight:700},children:\"Similarity:\"}),\" \",(item.score*100).toFixed(2),\"%\"]}),/*#__PURE__*/_jsx(\"pre\",{style:{background:'#232323',padding:20,borderRadius:12,fontSize:17,color:'#fff',whiteSpace:'pre-wrap',fontWeight:500,margin:0,boxShadow:'0 1px 4px rgba(162,89,255,0.05)'},children:item.text})]},item.id))}),!loading&&!error&&results.length===0&&query&&/*#__PURE__*/_jsx(\"div\",{style:{color:'#bfc9d9',fontSize:20},children:\"No similar results found.\"})]});}export default SimilaritySearch;","map":{"version":3,"names":["React","useState","apiUrl","jsx","_jsx","jsxs","_jsxs","accentGradient","accentText","background","WebkitBackgroundClip","WebkitTextFillColor","fontWeight","SimilaritySearch","_ref","projectId","query","setQuery","results","setResults","loading","setLoading","error","setError","handleSearch","e","preventDefault","res","fetch","method","headers","body","JSON","stringify","project_id","Number","undefined","data","json","err","className","style","width","maxWidth","margin","padding","children","fontSize","marginBottom","onSubmit","type","value","onChange","target","placeholder","borderRadius","border","color","length","map","item","boxShadow","filename","Date","created_at","toLocaleString","score","toFixed","whiteSpace","text","id"],"sources":["/Users/riccardorubini/Devs/AI-platform/OCR-test/frontend/src/SimilaritySearch.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { apiUrl } from './api';\n\nconst accentGradient = 'linear-gradient(90deg, #a259ff 0%, #4f8cff 100%)';\nconst accentText = {\n  background: accentGradient,\n  WebkitBackgroundClip: 'text',\n  WebkitTextFillColor: 'transparent',\n  fontWeight: 700,\n};\n\nfunction SimilaritySearch({ projectId }) {\n  const [query, setQuery] = useState('');\n  const [results, setResults] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  const handleSearch = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n    setError('');\n    setResults([]);\n    try {\n      const res = await fetch(apiUrl('/texts/similarity'), {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ query, project_id: projectId ? Number(projectId) : undefined }),\n      });\n      const data = await res.json();\n      setResults(data);\n    } catch (err) {\n      setError('Failed to fetch similarity results');\n    }\n    setLoading(false);\n  };\n\n  return (\n    <div className=\"main-responsive-box\" style={{ width: '100%', maxWidth: 1100, margin: '0 auto', padding: '0 5vw' }}>\n      <h2 style={{ fontSize: 38, marginBottom: 32, ...accentText }}>Similarity Search (Embeddings)</h2>\n      <form onSubmit={handleSearch} className=\"row g-2 align-items-center mb-4\" style={{ marginBottom: 32 }}>\n        <div className=\"col-12 col-md-9 mb-2 mb-md-0\">\n          <input\n            type=\"text\"\n            value={query}\n            onChange={e => setQuery(e.target.value)}\n            placeholder=\"Enter a query to find similar texts...\"\n            className=\"form-control bg-dark text-white\"\n            style={{ padding: 16, borderRadius: 12, border: '2px solid #4f8cff', fontSize: 18, fontWeight: 500 }}\n          />\n        </div>\n        <div className=\"col-12 col-md-3 d-grid\">\n          <button type=\"submit\" className=\"btn btn-primary\" style={{ borderRadius: 12, padding: '14px 36px', fontWeight: 700, fontSize: 18 }}>\n            Search\n          </button>\n        </div>\n      </form>\n      {loading && <div style={{ color: '#bfc9d9' }}>Loading...</div>}\n      {error && <div style={{ color: '#e63946' }}>{error}</div>}\n      {!loading && !error && results.length > 0 && (\n        <div className=\"d-flex flex-column gap-4\">\n          {results.map((item) => (\n            <div key={item.id} className=\"mx-auto w-100\" style={{ background: '#191919', borderRadius: 20, boxShadow: '0 2px 12px rgba(162,89,255,0.08)', padding: 32, color: '#fff', fontSize: 18, fontWeight: 500, maxWidth: 900, border: '1.5px solid #232323' }}>\n              {item.filename && (\n                <div style={{ marginBottom: 10, color: '#bfc9d9', fontSize: 16 }}>\n                  <span style={{ fontWeight: 700, color: '#fff' }}>File:</span> {item.filename}\n                </div>\n              )}\n              <div style={{ marginBottom: 10, color: '#bfc9d9', fontSize: 16 }}>\n                <span style={{ fontWeight: 700, color: '#fff' }}>Saved:</span> {new Date(item.created_at).toLocaleString()} | <span style={{ color: '#a259ff', fontWeight: 700 }}>Similarity:</span> {(item.score * 100).toFixed(2)}%\n              </div>\n              <pre style={{ background: '#232323', padding: 20, borderRadius: 12, fontSize: 17, color: '#fff', whiteSpace: 'pre-wrap', fontWeight: 500, margin: 0, boxShadow: '0 1px 4px rgba(162,89,255,0.05)' }}>{item.text}</pre>\n            </div>\n          ))}\n        </div>\n      )}\n      {!loading && !error && results.length === 0 && query && (\n        <div style={{ color: '#bfc9d9', fontSize: 20 }}>No similar results found.</div>\n      )}\n    </div>\n  );\n}\n\nexport default SimilaritySearch; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}